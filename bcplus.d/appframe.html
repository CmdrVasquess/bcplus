<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BC+ `version`: `title`</title>
    <link rel="stylesheet" href="s/css/bcp.css">
<!-- >>> dyn-styles <<< -->
<!-- >>> title-offline >>> -->
–offline–
<!-- <<< title-offline <<< \-->
<!-- >>> title-online >>> -->
CMDR `cmdr-name`
<!-- <<< title-online <<< \-->
  </head>
  <body>
<!-- >>> body <<< -->
<!-- >>> body-offline >>> -->
   <header style="display:block;" class="center">
	  <h1>…offline…</h1>
	</header>
	<main class="center">
	<p>Please boot up your main board computer systems to connect.</p>
	<img src="s/img/EDLoader.svg" alt="loading…" style="margin-top:5em;">
	</main>
<!-- <<< body-offline <<< \-->
<!-- >>> body-online >>> -->
	<header>
	<a href="https://github.com/CmdrVasquess/BCplus/wiki" target="home"><img
	 id="bcplogo" src="s/img/Logo.png"></a>
	<div id="switches">
		<img id="off" src="s/img/OnOff.png" title="Double-click to shutdown BC+" ondblclick="quit()">
		<img id="menu" src="s/img/Menu.png" title="NYI! Settings">
	</div>
	<div id="base">
	<p>CMDR `cmdr-name`<p>
	<p>`credits` Cr</p>
	<p>`ship-name` / `ship-ident`</p>
	<p>`ship-type`</p>
	</div>
	<div class="rank">
		<img class="logo" src="s/rnk/combat/`rlvl-combat`.png">
		<div><p>Combat: `rnk-combat`</p><p>`rlvl-combat`/8 +`rprg-combat`%</p></div>
	</div>
	<div class="rank">
		<img class="logo" src="s/rnk/trading/`rlvl-trade`.png">
		<div><p>Trading: `rnk-trade`</p><p>`rlvl-trade`/8 +`rprg-trade`%</p></div>
	</div>
	<div class="rank">
		<img class="logo" src="s/rnk/explorer/`rlvl-explorer`.png">
		<div><p>Explorer: `rnk-explorer`</p><p>`rlvl-explorer`/8 +`rprg-explorer`%</p></div>
	</div>
	<div class="rank">
		<img class="logo" src="s/rnk/cqc/`rlvl-cqc`.png">
		<div><p>CQC: `rnk-cqc`</p><p>`rlvl-cqc`/8 +`rprg-cqc`%</p></div>
	</div>
	<div class="locinfo">
		<div style="text-align:center">
			<img class="inlico btn" src="s/img/`home-flag`Home.png" title="Toggle Home System"
			     onclick="tglHome()"><br>
		   <img class="inlico btn" src="s/img/`dest-flag`Dest.png" title="Toggle Destination"
		        onclick="tglDest()">
		</div>&nbsp;
		<div><p>`location`</p><p>`locx` / `locy` / `locz`</p></div>
		<div style="margin-left:1em;"><p>Home: `home`</p><p>→ `homedist` Ly</p></div>
	</div>
	<div class="rank" style="justify-content: center">
		<img class="logo" src="s/fctn/feds.png" alt="Feds">
		<div><p>Federation: `rlvl-fed`/14</p><p>`rnk-fed` +`rprg-fed`%</p></div>
	</div>
	<div class="rank" style="justify-content: center">
		<img class="logo" src="s/fctn/imps.png" alt="Imps">
		<div><p>Empire: `rlvl-imp`/14</p><p>`rnk-imp` +`rprg-imp`%</p></div>
	</div>
	</header>
	<nav>
	  <ul>
<!-- >>> nav-items <<< \-->
<!-- >>> nav-item >>> -->
		<li><a href="`link`">`title`</a></li>

<!-- <<< nav-item <<< \-->
<!-- >>> nav-actv >>> -->
		<li><a href="`link`" class="active">`title`</a></li>

<!-- <<< nav-actv <<< \-->
	  </ul>
	</nav>
	<main>
	<br>
<!-- >>> topic <<< -->
	</main>
<!-- <<< body-online <<< \-->
	<footer id="status" title="`full-version`">&nbsp;</footer>
	<script>
var statLine = document.getElementById("status");
function showStatus(msg) {
	statLine.innerHTML = msg;
	setTimeout(function(){ statLine.innerHTML = "&nbsp;" }, 10000);
}
var wsurl = "ws://"+location.hostname+":"+location.port+"/ws";
var wsock = new WebSocket(wsurl);
function startWs() {
	// https://www.tutorialspoint.com/html5/html5_websocket.htm
	// .onerror(err); .onopen; .onmessage(msg); .onclose
	/*wsockUpd.onopen = function () {
	   showStatus('Event Channel Connected: '+wsurl);	   	
	}*/
	wsock.onerror = function (err) {
	   showStatus('Event Channel Error: '+err);	   	
	}
	wsock.onclose = function(evt) {
	   showStatus('Event Channel Closed: '+wsurl);
	   setTimeout(startWs(), 1500);
	}
	wsock.onmessage = function(evt) {
		var cmd = JSON.parse(evt.data)
	 	if (cmd.cmd == "reload") {
	   	location.reload(true);
	  	} else {
	     	showStatus('Event: ['+evt.data+']');
	   }
	}	   
}
function tglHome() {
	var rq = new Object()
	rq.topic = "all";
	rq.op = "tglhome";
	var msg = JSON.stringify(rq);
	wsock.send(msg);
}
function tglDest() {
	var rq = new Object()
	rq.topic = "all";
	rq.op = "tgldest";
	var msg = JSON.stringify(rq);
	wsock.send(msg);
}
function quit() {
	var rq = new Object()
	rq.topic = "all";
	rq.op = "quit";
	var msg = JSON.stringify(rq);
	wsock.send(msg);	
}
function send2kbd(e) {
	var txt = e.target.parentElement.innerText.trim();
	var rq = new Object();
	rq.topic = "all";
	rq.op = "skbd";
	rq.str = txt;
	var msg = JSON.stringify(rq);
	wsock.send(msg);

}
function higltSkbd(e) {
	var span = e.target.parentElement;
	span.classList.add("glow");
}
function lowltSkbd(e) {
	var span = e.target.parentElement;
	span.classList.remove("glow");
}
function decoSkbd(skbd) {
	skbd.appendChild(document.createTextNode(" "));
	var img = document.createElement("img")
	img.src = "s/img/Kbd.png";
	img.title = "Send as keyboard input";
	img.classList.add("skbd");
	img.addEventListener("click", send2kbd)
	img.addEventListener("mouseover", higltSkbd);
	img.addEventListener("mouseout", lowltSkbd);
	skbd.appendChild(img);
}
function decoAllSkbd() {
	var i, skbds = document.querySelectorAll("span.skbd");
	for (i = 0; i < skbds.length; i++) {
		decoSkbd(skbds[i])
	}
}
document.addEventListener('DOMContentLoaded', function () {
	if (window["WebSocket"]) {
		startWs()
	} else {
		alert("Your browser does not support WebSockets.")
	}
	decoAllSkbd();
})
	</script>
<!-- >>> script-end <<< \-->
  </body>
</html>
